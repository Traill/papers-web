{"id":"1569559199","paper":{"title":{"text":"A Factor-Graph Representation of Probabilities in Quantum Mechanics"},"authors":[{"name":"Hans-Andrea Loeliger"},{"name":"Pascal O. Vontobel"}],"abstr":{"text":"Abstract\u2014A factor-graph representation of quantum-mechani- cal probabilities is proposed. Unlike standard statistical models, the proposed representation uses auxiliary variables (state vari- ables) that are not random variables."},"body":{"text":"Statistical models with many variables are often represented by factor graphs [1]\u2013[4] or similar graphical representations [5]\u2013[7]. Such graphical representations can be helpful in various ways, including elucidation of the model itself as well as the derivation of algorithms for statistical inference.\nSo far, however, quantum mechanics (e.g., [8], [9]) has been standing apart. Despite being a statistical theory, quan- tum mechanics does not seem to ﬁt into standard statistical categories. Indeed, it has often been emphasized that quantum mechanics is a generalization of probability theory that cannot be understood in terms of \u201cclassical\u201d statistical modeling.\nIn this paper, we propose the different perspective that the probabilities in quantum mechanics are quite ordinary, but their state-space representation is of a type not previously used in statistical modeling. In particular, we propose a factor-graph representation of quantum mechanics that correctly represents the joint probability distribution of any number of measure- ments. Like most statistical models, the proposed factor graphs use auxiliary variables (state variables) in addition to the actually observed variables; however, in contrast to standard statistical models, the auxiliary variables in the proposed factor graphs are not random variables. Nonetheless, the probabilities of the observations are marginals of the factor graph, as in standard statistical models.\nThe paper is structured as follows. Section II reviews factor graphs and their connection to linear algebra and tensor diagrams. Section III makes the pivotal observation that factor graphs with complex factors and with auxiliary variables that are not random variables can represent probability mass functions. The main results are given in Section IV.\nWe will use standard linear algebra notation rather than the bra-ket notation of quantum mechanics. The Hermitian transpose of a complex matrix A will be denoted by A H = A T , where A T is the transpose of A and A is the componentwise complex conjugate. An identity matrix will be denoted by I.\nFactor graphs represent factorizations of functions of several variables. In this paper, all variables take values in ﬁnite\nalphabets and all functions take values in C. We will use Forney factor graphs (also called normal factor graphs) as in [2], [3] where nodes/boxes represent factors and edges represent variables. For example, assume that some function f (x 1 , . . . , x 5 ) can be written as\nThe Forney factor-graph notation is intimately connected with the idea of \u201cclosing boxes\u201d by summing over inter- nal variables [2]. For example, closing the inner dashed box in Fig. 2 replaces the two nodes/factors f 2 (x 2 , x 3 ) and f 3 (x 3 , x 4 , x 5 ) by the single node/factor\nclosing the outer dashed box in Fig. 2 replaces all nodes/ factors in (1) by the single node/factor\nand closing ﬁrst the inner dashed box and then the outer dashed box replaces all nodes/factors in (1) by\nr \t z AB\nNote the equality between (4) and (3), which holds in general: closing an inner box within some outer box (by summing over its internal variables) does not change the closed-box function of the outer box.\nA half edge in a factor graph is an edge that is connected to only one node (such as x 1 in Fig. 1). The external function of a factor graph (in [12]\u2013[14] also called partition function) is deﬁned to be the closed-box function of a box that contains all nodes and all full edges, but all half edges stick out (such as the outer box in Fig. 2). The external function of Fig. 1 is (3).\nThe corresponding node (which is denoted by \u201c=\u201d) can serve as a branching point in a factor graph, cf. Figs. 7\u201311.\nThe multiplication of two matrices A and B can then be written as\nwhich is the closed-box function (the external function) of Fig. 3. Note that the identity matrix corresponds to an equality constraint function f = (x, y).\nwhich is the external function (which is a constant) of the factor graph in Fig. 4. Also shown in Fig. 4 is the graphical proof of the identity tr(AB) = tr(BA), which is much used in quantum mechanics.\nFactor graphs for linear algebra operations such as Fig. 3 and Fig. 4 (and the corresponding generalizations to tensors) are essentially tensor diagrams (or trace diagrams) as in [10], [11]. This connection between factor graphs and tensor diagrams was noted in [12]\u2013[14].\nStatistical models usually contain auxiliary variables in addition to the observable variables. Consider, for example, a hidden Markov model with observables Y 1 , . . . , Y n and auxiliary variables (hidden variables) X 0 , X 1 , . . . , X n such that\nThe factor graph of (9) is given in Fig. 5. (As shown in this example, variables in factor graphs are often denoted by capital letters [2].) Closing the dashed box in Fig. 5 yields p(y 1 , . . . , y n ), the probability mass function of the observables.\nAs illustrated by this example, auxiliary variables in sta- tistical models are often introduced in order to obtain nice state-space models.\nIn traditional statistical models, such auxiliary state vari- ables are themselves random variables, and the total model is a joint probability law over all variables as, e.g., in (9). (A statistical model may also contain parameters in addition to auxiliary random variables, but such parameters are not relevant for the present discussion.)\nThe ﬁrst main point of this paper is this: requiring the auxiliary state variables to be random variables may be unnec- essarily restrictive. The beneﬁts of state-space representations may be obtained by merely requiring a function f (y, x) (with a useful factorization) such that the probability mass function of the observables is\nthe function f (y, x) need not be a probability mass function and it need not even be real valued.\nFor example, consider the factor graph in Fig. 6, where all factors are complex valued. Note that the lower dashed box in Fig. 6 mirrors the upper dashed box, but all factors in the lower box are the complex conjugates of the corresponding factors in the upper dashed box. The closed-box function of the upper dashed box is\nIf follows that the closed-box function in Fig. 6 (with both dashed boxes closed) is\nwhich is real and nonnegative and thus suitable to represent a probability mass function p(y 1 , y 2 , y 3 ) (up to a scale factor).\nWe will see that factor graphs as in Fig. 6\u2014with two parts, one part being the complex conjugate mirror image of the other part\u2014can represent probabilities in quantum mechanics.\nConsider the factor graph of Fig. 7. In this ﬁgure, U 0 and U 1 are M × M unitary matrices, and all variables except Y 1 and Y 2 take values in the set {1, . . . , M }. The two large boxes in the ﬁgure represent measurements, as will be detailed below. The factor/box p(x 0 ) is a probability mass function over the initial state X 0 . We will see that this factor graph (with suitable modeling of the measurements) represents the joint probability mass function p(y 1 , y 2 ) of a general M -dimensional quantum system with two observations Y 1 and Y 2 . The generalization to more observed variables Y 1 , Y 2 , . . . is obvious.\nThe unitary matrices U 0 and U 1 in Fig. 7 represent the development of the system between the initial state and the ﬁrst measurement, or between measurements, respectively, according to the Schr¨odinger equation.\nIn the most basic case, the initial state X 0 = x 0 is known and the measurements look as shown in Fig. 8, where the matrices B 1 and B 2 are also unitary. In this case, the observed variables Y 1 and Y 2 take values in {1, . . . , M } as well. Note that the lower part of this factor graph is the complex conjugate mirror of the upper part (as in Fig. 6).\nIn quantum-mechanical terms, measurements as in Fig. 8 are projection measurements with one-dimensional eigenspaces. Note that the value of Y 1 and Y 2 is the index of the measured eigenspace (rather than the corresponding eigenvalue).\nA very general form of measurement is shown in Fig. 11. In this case, the range of Y k is a ﬁnite set Y k , and for each y ∈ Y k , the factor A k (˜ x k , x k , y) corresponds to a complex square matrix A k (y) (with row index ˜ x k and column index x k ) such that\n(see [9, Chap. 2]). Measurements as in Fig. 8 are included as a special case with Y k = {1, . . . , M } and\nIt is clear from Section III that the external function of Fig. 7 (with measurements as in Fig. 8 or as in Fig. 11) is real and nonnegative. We now proceed to analyze these factor graphs and to verify that they yield the correct quantum- mechanical probabilities p(y 1 , y 2 ) for the respective class of measurements. To this end, we need to understand the closed- box functions of the dashed boxes in Fig. 9. We begin with the dashed box on the right-hand side of Fig. 9, where Y 2 is assumed to be unknown.\nProposition 1. Closing the dashed box on the right-hand side in Fig. 9 (with a measurement of Y 2 as in Fig. 8 or as in Fig. 11, but with unknown result of the measurement) reduces it to an equality constraint function. \t 2\nThe proof of this proposition and the proofs of the subsequent propositions are easy, and are omitted due to space constraints.\nProposition 1 guarantees, in particular, that a future mea- surement (with as yet unknown results) does not inﬂuence present or past observations.\nThe proposition clearly holds also for the extension of Fig. 7 to any ﬁnite number of measurements Y 1 , Y 2 , . . . and can then be applied recursively from right to left.\nApplying reductions according to Proposition 1 recursively from right to left in Fig. 7 leads to the following proposition.\nProposition 2. The factor graph of Fig. 7 (with measurements as in Fig. 8 or as in Fig. 11) represents a properly normalized probability mass function, i.e., the external function p(y 1 , y 2 ) is real and y\nConsider now the dashed box on the left in Figs. 9 and 10, which turns out to be the density matrix of quantum me- chanics. We will distinguish between the closed-box function ρ k (x k , x k ) before measuring Y k (as in Fig. 9), and the closed- box function ˜ ρ k (˜ x k , ˜ x k ) after the observation Y k = y k (as in Fig. 10). The former is easily seen to be properly nor- malized, but the latter needs normalization to satisfy (16). The corresponding matrices will be denoted by ρ k and ˜ ρ k , respectively. The proper normalization can then be expressed by the condition\nProposition 3 (Unitary Evolution Between Measurements). The matrix ρ k+1 is obtained from the matrix ˜ ρ k as\nρ k+1 = U k ˜ ρ k U H k . \t (17) 2\nProposition 4 (Basic Projection Measurement). In Fig. 7 (generalized to any number of observations), if Y k is measured\n= ˜ X\n= ˜ X\n= ˜ X\n= B k (y) H ρ k B k (y) \t (18) = tr B k (y)B k (y) H ρ k , \t (19)\nwhere B k (y) is the y-th column of B k . After measur- ing/observing Y k = y, the density matrix is\n˜ ρ k = B k (y)B k (y) H . \t (20) 2\nNote that (20) is properly normalized because tr(B k (y)B k (y) H ) = tr(B k (y) H B k (y)) = B k (y) 2 = 1.\nIn the special case of Fig. 8, with known initial state X 0 = x 0 , the matrix ρ k factors as\nwhere ψ k is a column vector of norm 1. The post-measurement density matrix ˜ ρ k factors analoguously, as is obvious from (20). In quantum-mechanical terms, ψ k is the quantum state. The probability (18) can then be expressed as\n= B k (y) H ψ k ψ H k B k (y) \t (23) = B k (y) H ψ k 2 , \t (24)\nwhich is the most basic form of computing probabilities in quantum mechanics.\nProposition 5 (General Measurement). In Fig. 7 (general- ized to any number of observations), if Y k is measured as in Fig. 11, then\nAccording to Propositions 2\u20135, the factor graph of Fig. 7 (with measurements as in Fig. 8 or as in Fig. 11) yields indeed the correct quantum-mechanical probabilities for the respective class of measurements.\nWe have proposed a class of factor graphs that represent quantum-mechanical probabilities involving any number of measurements, both for basic projection measurements and for general measurements as in [9, Chap. 2]. Such factor graphs have not previously been used in statistical modeling.\nThe space constraints of this paper preclude the discussion of further pertinent topics that we intend to address elsewhere, including the meaning of such factor graphs from a statistical- modeling point of view (disregarding physics), the relation to quantum Bayesian networks (see, e.g., [15]), to quantum belief propagation (see, e.g., [16]), and to tensor diagrams/networks for analyzing quantum systems (see, e.g., [17]). It is also noteworthy that quantum circuits as in [9, Chap. 4] may be viewed as halves of factor graphs as in this paper, where the missing other half is a complex conjugate mirror image as in Section III."},"refs":[{"authors":[{"name":"F. R. Kschischang"},{"name":"B. J. Frey"},{"name":"H.-A. Loeliger"}],"title":{"text":"Factor graphs and the sum-product algorithm"}},{"authors":[{"name":"H.-A. Loeliger"}],"title":{"text":"An introduction to factor graphs"}},{"authors":[{"name":"H.-A. Loeliger"},{"name":"J. Dauwels"},{"name":"S. Korl"},{"name":"F. R. Kschi- schang"}],"title":{"text":"The factor graph approach to model-based signal processing"}},{"authors":[{"name":"M. M´ezar"},{"name":"A. Montanar"}],"title":{"text":"Information, Physics, and Computation"}},{"authors":[{"name":"M. I. Jordan"}],"title":{"text":"Graphical models"}},{"authors":[{"name":"M. Bisho"}],"title":{"text":"Ch"}},{"authors":[{"name":"D. Kolle"},{"name":"N. Friedma"}],"title":{"text":"Probabilistic Graphical Models"}},{"authors":[{"name":"G. Aulett"},{"name":"M. Fortunat"},{"name":"G. Paris"}],"title":{"text":"Quantum Mechanics"}},{"authors":[{"name":"M. A. Nielse"},{"name":"I. L. Chuan"}],"title":{"text":"Quantum Computation and Quantum Information"}},{"authors":[{"name":"P. Cvitanovi´"}],"title":{"text":"Group Theory: Birdtracks, Lie\u2019s, and Exceptional Groups"}},{"authors":[{"name":"E. Peterson"}],"title":{"text":"Unshackling linear algebra from linear notation"}},{"authors":[{"name":"A. Al-Bashabsheh"},{"name":"Y. Mao"}],"title":{"text":"Normal factor graphs and holographic transformations"}},{"authors":[{"name":"G. D. Forney"},{"name":"P. O. Vontobel"}],"title":{"text":"Partition functions of normal factor graphs"}},{"authors":[{"name":"A. Al-Bashabsheh"},{"name":"Y. Mao"},{"name":"P. O. Vontobel"}],"title":{"text":"Normal factor graphs: a diagrammatic approach to linear algebra"}},{"authors":[{"name":"R. R. Tucci"}],"title":{"text":"Quantum information theory \u2013 a quantum Bayesian net perspective"}},{"authors":[{"name":"M. S. Leifer"},{"name":"D. Poulin"}],"title":{"text":"Quantum graphical models and belief propagation"}},{"authors":[{"name":"Z.-C. Gu"},{"name":"M. Levin"},{"name":"X.-G. Wen"}],"title":{"text":"Tensor-entanglement renormal- ization group approach as a uniﬁed method for symmetry breaking and topological phase transitions"}}]},"file":{"jsonClass":"File","file":"/home/arnfred/Code/trailhead/resources/isit2012/1569559199.pdf"},"links":[{"id":"1569565883","weight":3},{"id":"1569565867","weight":3},{"id":"1569564605","weight":3},{"id":"1569566855","weight":6},{"id":"1569566697","weight":6},{"id":"1569566761","weight":12},{"id":"1569564805","weight":3},{"id":"1569566409","weight":6},{"id":"1569565355","weight":6},{"id":"1569566739","weight":9},{"id":"1569566999","weight":3},{"id":"1569566925","weight":3},{"id":"1569565897","weight":3},{"id":"1569566749","weight":3},{"id":"1569567009","weight":3},{"id":"1569565785","weight":16},{"id":"1569566617","weight":3},{"id":"1569566311","weight":3},{"id":"1569565257","weight":3},{"id":"1569559805","weight":3},{"id":"1569565735","weight":6},{"id":"1569566447","weight":3},{"id":"1569556671","weight":3},{"id":"1569558401","weight":3},{"id":"1569565469","weight":3},{"id":"1569567235","weight":9},{"id":"1569566133","weight":3},{"id":"1569565665","weight":19},{"id":"1569566983","weight":3},{"id":"1569565241","weight":3},{"id":"1569566917","weight":3},{"id":"1569564291","weight":3},{"id":"1569566639","weight":6},{"id":"1569566819","weight":3},{"id":"1569565541","weight":3},{"id":"1569565597","weight":3},{"id":"1569564787","weight":9},{"id":"1569565529","weight":3},{"id":"1569564923","weight":3},{"id":"1569566601","weight":6},{"id":"1569566147","weight":6},{"id":"1569566273","weight":3},{"id":"1569566797","weight":3},{"id":"1569565707","weight":3},{"id":"1569558697","weight":9},{"id":"1569566113","weight":3}],"meta":{"jsonClass":"HashMap$HashTrieMap","sessionid":"S4.T5.4","endtime":"18:00","authors":"Hans-Andrea Loeliger, Pascal Vontobel","date":"1341250800000","papertitle":"A Factor-Graph Representation of Probabilities in Quantum Mechanics","starttime":"17:40","session":"S4.T5: Codes on Graphs","room":"Kresge Little Theatre (035)","paperid":"1569559199"},"cluster":{"jsonClass":"Map$EmptyMap$"}}
